<body>

    <header class="header header--standard header--market-place-4" data-sticky="true">
        <!--=====================================
        Header Content
        ======================================-->

        <div class="header__content">
            <div class="container">
                <div class="header__content-left">
                    <!--=====================================
                    Logo
                    ======================================-->
                    <a class="ps-logo" href="index.html">
                    <img src="../../../assets/icono.png" class="pt-3" alt="">
                    </a>
                    <!--=====================================
                    Menú
                    ======================================-->
                    <div class="menu--product-categories">
                        <div class="menu__toggle" (click)="redirigir()">
                            <i class="icon-menu"></i>
                        </div>
                    </div><!-- End menu-->
                </div><!-- End Header Content Left-->
                <!--=====================================
                Search
                ======================================-->
                <div class="header__content-center">
                    <form class="ps-form--quick-search" action="index.html" method="get" >
                        <dx-autocomplete 
                                            [dataSource]="listacompletaproductos"
                                            [(value)]="nomb"
                                            valueExpr="nombre"
                                            placeholder="Nombre del producto" class="buscador">
                                        </dx-autocomplete>
                        <button >Buscar</button>
                    </form>
                </div>

                <div class="header__content-right">
                    <div class="header__actions">
                       
                        <!--=====================================
                        Cart
                        ======================================-->
                        <div class="ps-cart--mini">

                            <a *ngIf="!existecarrito" class="header__extra" href="#">
                                <i class="icon-bag2 "></i><span><i>0</i></span>
                            </a>
                            <a *ngIf="existecarrito" class="header__extra" href="#">
                                <i class="icon-bag2 text-warning"></i><span><i>{{contadorcarrito}}</i></span>
                            </a>

                            <div *ngIf="!desactivarcarrito" class="ps-cart__content">
                                <div class="ps-cart__items">
                                    <div class="ps-product--cart-mobile" *ngFor="let element of productosOrdenDTO;let i = index">
                                        <div class="ps-product__thumbnail">
                                            <a href="#">
                                                <img src="{{element.imagen}}" alt="">
                                            </a>
                                        </div>

                                        <div class="ps-product__content">
                                            <a class="ps-product__remove"  (click)="eliminarRegistro(i, element)">
                                                <i class="icon-cross"></i>
                                            </a>
                                            <a>{{element.nombre}}</a><br>
                                           
                                            <small>{{element.cantidad}} x ${{element.precio_producto}}</small>
                                        </div>
                                    </div>
                                </div>

                                <div class="ps-cart__footer">
                                    <h3>Total:<strong>${{totalCompra}}</strong></h3>
                                    <div class="row">
                                        <div class="col-md-1"></div>
                                        <div class="col-md-10" style="text-align: center;">
                                                <a class="ps-btn color-principal" (click)="verCarrito()">Ver Carrito</a>
                                        </div>
                                        <div class="col-md-1"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!--=====================================
                        Login and Register
                        ======================================-->

                        <div class="ps-block--user-header">
                            <div class="ps-block__left">
                                <i style="cursor:pointer;" class="icon-user" (click)="irPerfilUsuario()"></i>
                            </div>
                            <div class="ps-block__right" *ngIf="!isLoged">
                                <a routerLink="/login">Ingresar</a>
                                <a routerLink="/register">Registrar</a>
                            </div>
                            <div class="ps-block__right" *ngIf="isLoged">
                                <a (click)="irPerfilUsuario()">{{nombreUsuario}}</a>
                                <a (click)="logout()">Salir</a>
                            </div>
                        </div>
                    </div><!-- End Header Actions-->
                </div><!-- End Header Content Right-->
            </div><!-- End Container-->
        </div><!-- End Header Content-->
    </header>


    <br><br><br><br><br><br>
    <div class="row">
        <div class="col-md-2"></div>
        <div class="col-md-8">
            <div style="text-align: center;"><h4>Productos Disponibles</h4></div>

            <div class="row centrar" *ngIf="listaprocompleto.length == 0">
                <div class="col-md-12"><h2>No hay productos disponibles</h2></div>
            </div>
            
            <div class="row">
                <div class="col-md-4" *ngFor="let element of listacompletaproductos">
                   <br>
                   <div class="card cardProductos">
                       <br>
                       <h4>{{element.nombre}}</h4>
                       <img src="{{element.imagen}}" alt="Imagen del producto" style="width:125pt; height: 150pt; margin:auto" (click)="mostrarPopup(element)">
                       <p><span>Tienda:</span>  {{element.nombre_ti}}</p>
                       <p><span>Categoría:</span>  {{element.descripcion_cat}}</p>
                       <p><span>Subcategoria:</span> {{element.descripcion_sub}}</p>
                       <p><span>Precio:</span> {{element.precio}}</p>
                        <div class="row buttonP">
                            <div class="col-md-2"> </div>
                            <div class="col-md-8">
                                 <button class="color-principal btn" style="width: 80%; font-size: 13pt;" [disabled]="bloquear" (click)="mostrarPopupCompra(element)">Comprar</button>
                            </div>
                            <div class="col-md-2"> </div>
                        </div>
                        <br>
                   </div>
               </div> 
           </div>
        </div>
        <div class="col-md-2"></div>
    </div>

	
</body>


<dx-popup
    [width]="'60%'"
    [height]="'66%'"
    [closeOnOutsideClick]="true"
    [(visible)]="popupVisible">
    <div *dxTemplate="let data of 'content'">
        <div class="row" >
            <div class="col-md-4"><img src="{{productoMostrado.imagen}}" alt=""></div>
            <div class="col-md-8">
                <div class="row">
                    <div class="col-md-12"><h2>{{productoMostrado.nombre}}</h2></div>
                    <div class="col-md-12">
                        <h4>Descripcion:</h4>
                        <p>{{productoMostrado.descripcion}}</p>
                    </div>
                    <div class="col-md-12">
                        <div class="row">
                            <div class="col-md-4"><h5>Cantidad Disponible:</h5></div>
                            <div class="col-md-8">{{productoMostrado.stock}}</div>
                        </div>
                    </div>
                    <div class="col-md-12">
                        <div class="row">
                            <div class="col-md-4"><h5>Categoria:</h5></div>
                            <div class="col-md-8">{{productoMostrado.descripcion_cat}}</div>
                        </div>
                    </div>
                    <div class="col-md-12">
                        <div class="row">
                            <div class="col-md-4"><h5>Sub-Categoria:</h5></div>
                            <div class="col-md-8">{{productoMostrado.descripcion_sub}}</div>
                        </div>
                    </div>
                    <div class="col-md-12">
                        <div class="row">
                            <div class="col-md-4"><h5>Precio:</h5></div>
                            <div class="col-md-8">${{productoMostrado.precio}}</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</dx-popup>

<dx-popup
    [width]="'50%'"
    [height]="'70%'"
    [(visible)]="popupCompra">
    <div *dxTemplate="let data of 'content'">
        <div class="ps-section__content centrar">
            <div class="row">
                <div class="col-md-1"></div>
                <div class="col-md-10">
                    <div class="table-responsive">
                    <div class="row">
                        <div class="col-md-6"><img src="{{productoAComprar.imagen}}" alt="" style="width: auto;height: 25rem;"></div>
                        <div class="col-md-4">
                            <br><br>
                            <h4>{{productoAComprar.nombre}}</h4><br>
                            <h4>Cantidad disponible: {{productoAComprar.stock}}</h4>
                        </div>
                        <div class="col-md-2"></div>
                    </div>
                    <div class="row">
                        <div class="col-md-1"></div>
                        <div class="col-md-10">
                            <p style="color: red;font-weight: bold;">{{mensajeError}}</p>
                            <table class="table ps-table--shopping-cart centrar">
                                <thead>
                                    <tr>
                                        <th>Precio</th>
                                        <th>Cantidad</th>
                                        <th>Total</th>
                                        <th></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="price">${{productoAComprar.precio}}</td>
                                        <td>
                                            <div class="form-group--number">
                                                <dx-number-box [(value)]="nuevoProductoOrden.cantidad" (onChange)="validarCantidad()" ></dx-number-box>
                                                </div>
                                        </td>
                                        <td>${{nuevoProductoOrden.total_producto}}</td>                             
                                        
                                    </tr>
                                </tbody>
                            </table>
                            <div class="row">
                                <div class="col-md-4"></div>
                                <div class="col-md-4"><button class="btn color-principal" [disabled]="!isCorrecto" (click)="validarTiendaProducto()">Añadir al Carrito</button></div>
                                <div class="col-md-4"></div>
                            </div>
                            
                        </div>
                        <div class="col-md-1"></div>
                    </div>
                    
                </div>
                </div>
                <div class="col-md-1"></div>
            </div>
        </div> 
    </div>
</dx-popup>


<dx-popup
[width]="'20%'"
[height]="'33%'" 
[showCloseButton]="false"
[showTitle]="true"
title="Cantidad no disponible"


[(visible)]="popupaceptarcantidad">
<div *dxTemplate="let data of 'content'">
    <div class="ps-section__content centrar">
        <div class="row">
            
            <div class="col-md-12">
               <br>
                <label for=""> La cantidad solicitada del producto . </label><label for=""><strong> {{productoAComprar .nombre}}</strong></label><label for=""> excede el stock disponible del producto</label><br><strong></strong><label for=""><strong>¿Desea asignar el stock màximo del producto, el cúal es {{productoAComprar .stock}} ?</strong></label>
                <br><br>
                <div class="row">
                    <br>
                    <div class="col-md-6"><button class="btn color-principal" style="font-size:1.5rem ; width: 6rem;"  (click)="poputaceptacioncantidad()">ok</button></div>
                    
                    <div class="col-md-6"><button class="btn btn-danger" style="font-size:1.5rem ; width: 8rem;" (click)="poputrechazarcantidad()">cancelar</button></div>
                   
                    <br>
                </div>
 
                <br>
            </div>           
        </div>

    </div> 

</div>

</dx-popup>
